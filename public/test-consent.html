<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Consent Banner Test</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      line-height: 1.6;
    }
    .status { 
      background: #f0f0f0; 
      padding: 20px; 
      border-radius: 8px;
      margin: 20px 0;
    }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover { background: #0056b3; }
    .danger { background: #dc3545; }
    .danger:hover { background: #c82333; }
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }
    pre {
      background: #f4f4f4;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>üç™ Consent Banner Test Utility</h1>
  
  <div class="status" id="status">
    <h2>Current Status</h2>
    <p id="consent-status">Checking...</p>
    <p id="cookie-status">Checking...</p>
    <p id="banner-status">Checking...</p>
  </div>

  <div>
    <h2>Quick Actions</h2>
    <button onclick="checkStatus()">üîç Check Status</button>
    <button onclick="clearConsent()" class="danger">üóëÔ∏è Clear Consent</button>
    <button onclick="window.location.href='/'">üè† Go to Homepage</button>
  </div>

  <div>
    <h2>Console Commands</h2>
    <p>Copy and paste these into your browser console (F12):</p>
    
    <h3>1. Clear Consent Data</h3>
    <pre>localStorage.removeItem('lunnoa_consent_preferences');
document.cookie = 'lunnoa_consent=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/';
location.reload();</pre>

    <h3>2. Check Current Consent</h3>
    <pre>console.log('LocalStorage:', localStorage.getItem('lunnoa_consent_preferences'));
console.log('Cookie:', document.cookie);</pre>

    <h3>3. Force Banner to Show (Debug)</h3>
    <pre>// This won't work unless you're on the main site
// Just showing the logic
localStorage.clear();
location.reload();</pre>
  </div>

  <div>
    <h2>Troubleshooting</h2>
    <ol>
      <li><strong>Banner not showing?</strong> Clear consent data using the red button above</li>
      <li><strong>Still not showing?</strong> Open browser console (F12) and look for üç™ messages</li>
      <li><strong>Console errors?</strong> Check if all files exist:
        <ul>
          <li><code>components/consent/ConsentBanner.jsx</code></li>
          <li><code>lib/consent-manager.js</code></li>
        </ul>
      </li>
      <li><strong>Language error?</strong> Make sure <code>LanguageProvider</code> is wrapping the banner</li>
    </ol>
  </div>

  <script>
    function checkStatus() {
      const localStorage = window.localStorage.getItem('lunnoa_consent_preferences');
      const cookie = document.cookie.split(';').find(c => c.includes('lunnoa_consent'));
      
      let status = '<h2>Current Status</h2>';
      
      if (localStorage) {
        status += '<p class="error">‚ùå Consent found in localStorage</p>';
        status += '<pre>' + localStorage + '</pre>';
      } else {
        status += '<p class="success">‚úÖ No consent in localStorage</p>';
      }
      
      if (cookie) {
        status += '<p class="error">‚ùå Consent cookie found</p>';
        status += '<pre>' + cookie + '</pre>';
      } else {
        status += '<p class="success">‚úÖ No consent cookie</p>';
      }
      
      if (!localStorage && !cookie) {
        status += '<p class="success"><strong>‚úÖ Banner should be visible!</strong></p>';
      } else {
        status += '<p class="error"><strong>‚ùå Banner will be hidden (consent exists)</strong></p>';
        status += '<p>Click "Clear Consent" and reload to see the banner</p>';
      }
      
      document.getElementById('status').innerHTML = status;
    }
    
    function clearConsent() {
      if (confirm('This will clear all consent data. Continue?')) {
        localStorage.removeItem('lunnoa_consent_preferences');
        document.cookie = 'lunnoa_consent=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        alert('Consent cleared! Reloading page...');
        location.reload();
      }
    }
    
    // Auto-check on load
    checkStatus();
  </script>
</body>
</html>
